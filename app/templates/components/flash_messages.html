{% set msgs = messages if messages is defined else get_flashed_messages(with_categories=true) %}
{% set data_id = data_new_recipe_id if data_new_recipe_id is defined else '' %}

{% if msgs %}
<div class="fixed top-6 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-xl space-y-3" {% if data_id %}
    data-new-recipe-id="{{ data_id }}" {% endif %}>
    {% for category, message in msgs %}
    <div
        class="flash-message opacity-0 translate-y-[-20px] transition-all duration-500 ease-out
               {% if category == 'success' %}bg-green-100 border-green-400 text-green-800
               {% elif category == 'warning' %}bg-yellow-100 border-yellow-400 text-yellow-800
               {% else %}bg-red-100 border-red-400 text-red-800{% endif %} border px-6 py-4 rounded-lg shadow-lg flex items-center justify-between">
        <span class="font-medium">{{ message }}</span>
        <button class="ml-4 text-xl font-bold text-gray-400 hover:text-gray-600"
            onclick="this.parentElement.remove()">Ã—</button>
    </div>
    {% endfor %}
</div>
{% endif %}

<script>
    document.querySelectorAll('.flash-message').forEach((el, i) => {
        // Animate in with stagger
        setTimeout(() => {
            el.classList.remove('opacity-0', 'translate-y-[-20px]');
            el.classList.add('opacity-100', 'translate-y-0');
        }, 100 * i);

        // Auto fade out and remove
        setTimeout(() => {
            el.classList.add('opacity-0', 'translate-y-[-20px]');
            setTimeout(() => el.remove(), 500);
        }, 4000 + i * 150);
    });
</script>